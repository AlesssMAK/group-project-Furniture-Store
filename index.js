import{a as j,i as c,A as z,S as K,N as V,P as G,R as J}from"./assets/vendor-0_PbKLAl.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&n(p)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();const w=document.querySelector(".burger"),a=document.querySelector(".mobile-menu"),Q=a.querySelector(".modal-window-close-btn"),W=a.querySelectorAll("a"),q=document.body;function X(){a.classList.add("open"),a.setAttribute("aria-hidden","false"),w.setAttribute("aria-expanded","true"),q.style.overflow="hidden"}function m(){a.classList.remove("open"),a.setAttribute("aria-hidden","true"),w.setAttribute("aria-expanded","false"),q.style.overflow=""}w.addEventListener("click",X);Q.addEventListener("click",m);a.addEventListener("click",e=>{e.target===a&&m()});document.addEventListener("keydown",e=>{e.key==="Escape"&&a.classList.contains("open")&&m()});W.forEach(e=>{e.addEventListener("click",()=>{m()})});const S=document.querySelector(".header-logo");S&&S.addEventListener("click",e=>{e.preventDefault(),m();const t=document.querySelector("#hero");t?t.scrollIntoView({behavior:"smooth"}):window.location.href="index.html"});const B=document.querySelector(".buy-btn");B&&B.addEventListener("click",e=>{e.preventDefault(),m();const t=document.querySelector("#furniture");t&&t.scrollIntoView({behavior:"smooth"})});const i={furnitureList:document.querySelector(".furniture-list-render"),productModal:document.querySelector(".furniture-details-modal"),productMadalContainer:document.querySelector(".furniture-modal-product"),modalOrderBtn:document.querySelector(".order-btn"),modalCloseBtn:document.querySelector(".modal-furnt-close-btn"),categoriesList:document.querySelector(".menu-list-section-iv"),loadMoreListBtn:document.querySelector(".btn-load-more-list"),orderModal:document.querySelector(".order-modal")},f=document.getElementById("loader"),d=()=>{f&&f.classList.remove("hidden")},l=()=>{f&&f.classList.add("hidden")},C=()=>{i.loadMoreListBtn.classList.remove("hidden")},b=()=>{i.loadMoreListBtn.classList.add("hidden")},Y="https://furniture-store.b.goit.study/api",g={FURNITURES:"/furnitures",CATEGORIES:"/categories",ORDERS:"/orders",FEEDBACKS:"/feedbacks"},h=j.create({baseURL:Y,headers:{"Content-Type":"application/json"}}),I=async e=>{d();try{return(await h.get(g.FURNITURES,{params:{page:e,limit:8}})).data}catch{return c.error({title:"Помилка",message:"Не вдалося завантажити меблі. Спробуйте пізніше.",position:"topRight",timeout:4e3}),null}finally{l()}},Z=async(e,t=1)=>{d();try{return(await h.get(g.FURNITURES,{params:{category:e,page:t,limit:8}})).data}catch{return c.error({title:"Помилка",message:"Не вдалося завантажити меблі. Спробуйте пізніше.",position:"topRight",timeout:4e3}),null}finally{l()}},ee=async(e=1,t=3)=>{d();try{return(await h.get(g.FEEDBACKS,{params:{page:e,limit:t}})).data}catch{return c.error({title:"Помилка",message:"Не вдалося завантажити відгуки. Спробуйте оновити сторінку.",position:"topRight",timeout:4e3}),null}finally{l()}},te=async e=>{d();try{const t=await h.post(g.ORDERS,e);return c.success({title:"Успіх!",message:"Замовлення успішно створено. Ми зв'яжемося з вами найближчим часом.",position:"topRight",timeout:4e3}),t.data}catch{return c.error({title:"Помилка замовлення",message:"Не вдалося створити замовлення. Перевірте дані та спробуйте ще раз.",position:"topRight",timeout:4e3}),null}finally{l()}};let O=[];const re=e=>{O=e},oe=e=>O.find(t=>t._id===e),ne=e=>{const{name:t,description:o,images:n,rate:r,price:s,sizes:p,color:N,category:x}=e,D=Math.round(r*2)/2,U=`
      <div class="gallery">
        <img src="${n[0]}" alt="${t}" class="gallery__item gallery__item--large" />
        <div class="gallery__row">
          <img src="${n[1]}" alt="${t}" class="gallery__item" />
          <img src="${n[2]}" alt="${t}" class="gallery__item" />
        </div>
      </div>
    `,H=N.map((k,M)=>`
    <label class="color-checkbox-label">
      <input
        type="radio"
        name="color"
        value="${k}"
        class="color-item"
        id="color-${M}"
        ${M===0?"checked":""}
      />
      <span class="color-checkbox-circle" style="background-color: ${k}"></span>
    </label>
  `).join("");i.productMadalContainer.innerHTML=`
      <div class="modal-product-img-gallery">${U}</div>
      <div class="furniture-modal-product-content">
        <h2 class="modal-product-title">${t}</h2>
        <p class="gategory-text">${x.name}</p>
        <p class="product-price">${s} грн</p>
        <div class="css-star-rating" data-rating="${D}"></div>
        <div class="color-picker">${H}</div>
        <p class="product-description">${o}</p>
        <p class="product-size">Розміри: ${p}</p>
        <button class="order-btn" type="button">Перейти до замовлення</button>
      </div>
    `},E=e=>{re(e);const t=e.map(({images:o,_id:n,type:r,price:s})=>`
    <li class="furniture-list-render-item" data-id="${n}">
      <img class="furniture-list-render-img" src="${o[0]}" alt="${r}" />
      <h3 class="furniture-list-render-title">${r}</h3>
      <ul class="furniture-list-render-color-list">
        <li class="furniture-list-render-color-list-item furniture-list-render-color-list-item-current-one"></li>
        <li class="furniture-list-render-color-list-item furniture-list-render-color-list-item-current-two"></li>
        <li class="furniture-list-render-color-list-item furniture-list-render-color-list-item-current-three"></li>
      </ul>
      <p class="furniture-list-render-price">${s} грн</p>
      <button class="furniture-list-render-btn" type="button">Детальніше</button>
    </li>
    `).join("");i.furnitureList.innerHTML=t};let u=1;l();const se=async()=>{u=1,d();const{furnitures:e,totalItems:t}=await I(u);l(),E(e);const o=Math.ceil(t/8);u>=o?c.info({title:"Повідомлення",message:"Всі меблі завантаженні.",position:"topRight",timeout:4e3}):C()},ie=async()=>{u++,b(),d();const{furnitures:e,totalItems:t}=await I(u);E(e),l();const o=Math.ceil(t/8);u>=o?c.info({title:"Повідомлення",message:"Всі меблі завантаженні.",position:"topRight",timeout:4e3}):C()};async function ce(e){d();const t=await Z(e);l(),t&&t.furnitures?(b(),E(t.furnitures)):(b(),i.furnitureList.innerHTML="<p>Не вдалося завантажити меблі.</p>")}const ae=async e=>{const t=e.target.closest(".btn-list-section-iv");console.log(t),t&&(P(t),ce(t.dataset.id))},le=()=>{const e=document.querySelector(".btn-list-section-iv");e&&P(e)},P=e=>{document.querySelectorAll(".btn-list-section-iv").forEach(t=>t.classList.remove("active-btn-iv")),e.classList.add("active-btn-iv")};se();document.addEventListener("DOMContentLoaded",()=>{i.categoriesList.addEventListener("click",ae),le()});i.loadMoreListBtn.addEventListener("click",ie);new z(".accordion-container",{duration:250,showMultiple:!1,onOpen:function(e){console.log(e)}});const R=document.getElementById("feedback-list"),$=document.getElementById("feedback-loader");function de(e){return e>=3.3&&e<=3.7?3.5:e>=3.8&&e<=4.2?4:Math.round(e)}function ue({name:e,descr:t,rate:o}){const n=de(o),r=document.createElement("div");return r.className="swiper-slide",r.innerHTML=`
    <div class="feedback-card">
      <div class="rating" data-score="${n}"></div>
      <p class="feedback-text">"${t}"</p>
      <p class="feedback-author">— ${e}</p>
    </div>
  `,new J(r.querySelector(".rating"),{readOnly:!0,score:n,starType:"i",starOn:"★",starOff:"☆",starHalf:"⯨"}),r}async function me(){$.classList.remove("visually-hidden"),R.innerHTML="";try{const e=await ee(1,10);console.log("Відгуки з API:",e);const t=e.feedbacks||[];if(!t.length){c.error({title:"Помилка",message:"Не отримано список відгуків з API",position:"topRight"});return}t.forEach(o=>{const n=ue({name:o.name||"Анонім",descr:o.descr||"",rate:o.rate||0});R.appendChild(n)}),new K(".swiper",{modules:[V,G],loop:!1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",clickable:!0}})}catch(e){console.error(e),c.error({title:"Помилка",message:"Не вдалося завантажити відгуки. Спробуйте пізніше.",position:"topRight"})}finally{$.classList.add("visually-hidden")}}me();const A=e=>{e.code==="Escape"&&v()},F=e=>{e.target===i.productModal&&v()},pe=e=>{i.productModal.classList.add("modal-is-open"),document.body.style.overflow="hidden",window.addEventListener("keydown",A),i.productModal.addEventListener("click",F)},v=()=>{i.productModal.classList.remove("modal-is-open"),document.body.style.overflow="",window.removeEventListener("keydown",A),i.productModal.removeEventListener("click",F)};i.modalCloseBtn.addEventListener("click",v);async function fe(e){const t=e.target.closest(".furniture-list-render-btn");if(!t)return;const o=t.closest(".furniture-list-render-item"),n=o==null?void 0:o.dataset.id;if(!n)return;const r=oe(n);if(!r){c.error({title:"Error",message:"Товар не знайдено у кеші"});return}ne(r),pe()}i.furnitureList.addEventListener("click",fe);document.addEventListener("click",e=>{e.target.closest(".order-btn")&&(v(),i.orderModal.classList.add("is-open"),document.body.style.overflow="hidden")});const T=document.querySelector(".modal-window-close-btn"),y=document.querySelector(".order-modal");document.querySelector(".modal-window-form");let _=null;function L(){y.style.display="none",y.classList.remove("is-open"),document.body.classList.remove("no-scroll"),_=null}T.addEventListener("click",L);T.addEventListener("keydown",e=>{e.key==="Escape"&&L()});y.addEventListener("click",e=>{e.target===y&&L()});form.addEventListener("submit",ye);async function ye(e){e.preventDefault();const t=e.target.elements["#user-email"].value.trim(),o=e.target.elements["#user-tel"].value.trim(),n=e.target.elements["#user-comment"].value.trim();if(!t){c.warning({message:'Заповніть поле "Email"!'});return}if(!o){c.warning({message:"Вкажіть номер телефону!"});return}if(n.length<4||n.length>63){c.warning({message:"Комментар не може бути від 5 до 64 символів"});return}await te({email:t,phone:o,comment:n,color,modelId:_}),L(),e.target.reset()}
//# sourceMappingURL=index.js.map
